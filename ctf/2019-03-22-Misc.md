[TOC]

# Misc

## 隐写题-答题思路
1. 先看题目, 根据题目搜索关键字
2. 文件属性-详细信息 ，各种奇怪的数据，加转码。
3. 010editor, 搜索Text型, flag, Unicode型 flag
3. 打开看文件内容
4. 文件异常：高度，宽度是否正常。
5. winhex分析，前部中部尾部
6. binwalk试下 binwalk -e new.jpg

        * tiff data, 用 Stegano_Stegsolve的 frame browser
        * 有zlib 可能需要 lsb, RGB 加密等，用Stegano_Stegsolve各种尝试。
7. 010editor 分析, 配合 dd命令 分离，或者直接010 editor中分离
    
        010editor 搜索 `\{[a-z\d]{4,}`, 选项勾上 Regular expression
        strings xiaojiejie.jpeg | grep -E "\{[a-z]{4,}"

7. foremost试下
8. Steghide 看下有没有隐写。 steghide.exe extract -sf filename
8. PNG文件：一定要使用windows照片查看器看，会忽略crc检验。
8. PNG文件：调整下高度，看看有没有flag。
8. PNG文件：普通浏览器不显示，直接用 windows照片查看器打开显示，可能改了宽度。暴破下过CRC32验证
9. pdf文件: chrome打开全选复制出来看看
10. pcapng 取证： 先用foremost分解看看。
11. zip/rar 文件，先 foremost 分离
11. zip/rar 文件，或 binwalk -e filename 解压
11. zip/rar 文件， 使用unzip或者winrar打开 逐个解压，因为包里可能有不需要密码的。
11. zip/rar 密码，先看题目提示，图片文件用010 editor搜索设置 Unicode型, 搜pass, 4位试下。不行再看总结。
12. 01001010 等二进制转字符串试试。
13. 路由相关使用 routerpassview 搜 username 或者是password
14. 音频, Audition 看看。多是摩斯码。
15. vmdk 一定要在Linux下7z解压: __7z x filename__
16.     


## png隐写

    00 00 00 0D 49 48 44 52 --0D头块长13, 49 48 44 52 IHDR标识
    00 00 01 f4 00 00 01 a4  宽:00 00 01 f4即500 高: 00 00 01 a4即 400
    08 06 00 00 00 cb d6 df 8a --- CRC校验 29:32 这4个字节是CRC

有时会改宽度，需要CRC校验的。

0x12,13 宽度, 大端模式, 999为03e7

0x16,17 高度

左上角为基点分别是向右拉和向下。宽度一般不会改，会进行CRC校验的。

pngcheck -v filename

Image photography线上和离线加密方式不同。

### png格式介绍1
参考链接

https://dev.gameres.com/Program/Visual/Other/PNGFormat.htm

https://blog.csdn.net/hherima/article/details/45847043

https://www.bilibili.com/video/BV1V4411Z7VA

00|01|02|03|04|05|06|07|08|09|0A|0B|0C|0D|0E|0F
--|--|--|--|--|--|--|--|--|--|--|--|--|--|--|--
89|50|4E|47|0D|0A|1A|0A|00|00|00|0D|49|48|44|52
00|00|00|0F|00|00|00|20|08|06|00|00|00|CD|2C|22
宽度1/4|2/4|3/4|4/4|高度1/4|2/4|3/4|4/4|Bit depth|ColorType|Compression Method|Filter method|Interlace Method|crc 1/4|2/4|3/4
A9 |
4/4|

### png格式介绍2

    89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52
    00 00 07 80 00 00 04 B0 

前四个字节00 00 00 0D（即为十进制的13）代表数据块的长度为13，数据块包含了png图片的宽高等信息，该段格式是固定的

之后的四个字节49 48 44 52（即为ASCII码的IHDR）是文件头数据块的标示，该段格式也是固定的

之后进入13位数据块，前8个字节00 00 05 56 00 00 03 00中：

前四个字节00 00 05 56（即为十进制的1366），代表该图片的宽，该段数据是由图片的实际宽决定的

后四个字节00 00 03 00（即为十进制的768），代表该图片的高，该段数据是由图片的实际高度决定的

这8个字节都属于13位数据块的内容，因此数据块应再向后数5个字节，即为00 00 05 56 00 00 03 00 08 02 00 00 00

剩余的4位40 5C AB 95为该png的CRC检验码，也就是本篇文章要重点讨论的地方，该段数据是由IDCH以及十三位数据块（即上文中的49 48 44 52 00 00 05 56 00 00 03 00 08 02 00 00 00）计算得到的
### 17 steghide隐写01\
将Misc.png拖入winhex发现尾部不对。
1. 用foremost 解压 Misc.png
2. 用steghide 解密 000112.jpg，出现密码
3. 打开pdf，输入密码。（或者暴破）

### 19 outguess隐写
outguess -r angrybird.jpg 11.txt

# 工具使用

## wifi.cap wifi密码破解

aircrack-ng -w /usr/share/wordlists/rockyou.txt wifi.cap

## notepad++
二进制转字符-转10进制

## binwalk -- kali 分析文件工具 分析头和尾
binwalk -e new.jpg

-e = extract 直接解压文件

\u1111\u2222 --- 要在Chrome里直接 F12 console加引号输出 , "\u1111\u2222" 回车。

## foremost -- kali 分析文件工具,并拆分隐藏的文件
[windows上使用foremost](https://www.cnblogs.com/cnnnnnn/p/8994362.html)

foremost new.jpg 

## Stegsolve --- LSB隐写
java -jar Stegsolve.jar

Analasys - Data Extract

最低位先用0 (alpha没变形没选)

√LSB First

测试每个 Bit Plane Order

      找到明显标志后保存 - Save Test 

SaveBin

## file 命令分析文件 或者winhex

## volatility 内存取证

## 文件头
字符串 PK是 zip的开头,  5d480506xxxxx 为尾部
